<el-card class="ai-console-card">
    <div slot="header">
        <h3>AI 控制台</h3>
    </div>
    
    <div class="ai-messages" ref="messagesContainer">
        <div v-for="(message, index) in messages" :key="index" class="message-item" :class="message.isUser ? 'user-message' : 'ai-message'">
            <div class="message-avatar">
                <i class="fa" :class="message.isUser ? 'fa-user' : 'fa-robot'"></i>
            </div>
            <div class="message-content">
                <p>{{ message.text }}</p>
                <div class="message-time">{{ message.timestamp }}</div>
            </div>
        </div>
    </div>
    
    <div class="ai-input-area">
        <el-input
            v-model="userInput"
            placeholder="输入你的问题..."
            @keyup.enter="sendMessage"
            clearable>
        </el-input>
        <el-button type="primary" @click="sendMessage" class="send-button">
            <i class="fa fa-paper-plane"></i> 发送
        </el-button>
    </div>
</el-card>

<script>
// 注册AI控制台组件
app.component('ai-console', {
    data() {
        return {
            messages: [
                {
                    text: "你好！我是你的AI助手，有什么可以帮助你的吗？",
                    isUser: false,
                    timestamp: this.formatTime(new Date())
                }
            ],
            userInput: "",
            isLoading: false
        };
    },
    methods: {
        sendMessage() {
            if (!this.userInput.trim() || this.isLoading) return;
            
            // 添加用户消息
            const userMessage = {
                text: this.userInput.trim(),
                isUser: true,
                timestamp: this.formatTime(new Date())
            };
            this.messages.push(userMessage);
            this.userInput = "";
            
            // 显示加载状态
            this.isLoading = true;
            
            // 模拟AI响应
            setTimeout(() => {
                const aiResponse = {
                    text: this.generateAIResponse(userMessage.text),
                    isUser: false,
                    timestamp: this.formatTime(new Date())
                };
                this.messages.push(aiResponse);
                this.isLoading = false;
                this.scrollToBottom();
            }, 1000);
            
            this.scrollToBottom();
        },
        formatTime(date) {
            return date.toLocaleTimeString();
        },
        scrollToBottom() {
            this.$nextTick(() => {
                const container = this.$refs.messagesContainer;
                container.scrollTop = container.scrollHeight;
            });
        },
        generateAIResponse(input) {
            // 简单的AI响应生成逻辑，实际应用中会调用真实的AI服务
            const responses = [
                "感谢你的提问。关于这个问题，我的理解是...",
                "这是一个很好的问题。根据我的分析...",
                "我明白你的意思。让我为你详细解释...",
                "对于这个问题，有几个方面需要考虑...",
                "你的想法很有见地。补充一点..."
            ];
            
            return responses[Math.floor(Math.random() * responses.length)] + "（这是模拟回复，实际应用中会调用AI服务）";
        }
    },
    mounted() {
        this.scrollToBottom();
    },
    template: `
        <el-card class="ai-console-card">
            <div slot="header">
                <h3>AI 控制台</h3>
            </div>
            
            <div class="ai-messages" ref="messagesContainer">
                <div v-for="(message, index) in messages" :key="index" class="message-item" :class="message.isUser ? 'user-message' : 'ai-message'">
                    <div class="message-avatar">
                        <i class="fa" :class="message.isUser ? 'fa-user' : 'fa-robot'"></i>
                    </div>
                    <div class="message-content">
                        <p>{{ message.text }}</p>
                        <div class="message-time">{{ message.timestamp }}</div>
                    </div>
                </div>
                
                <div v-if="isLoading" class="loading-indicator">
                    <el-loading-spinner></el-loading-spinner>
                    <span>AI正在思考...</span>
                </div>
            </div>
            
            <div class="ai-input-area">
                <el-input
                    v-model="userInput"
                    placeholder="输入你的问题..."
                    @keyup.enter="sendMessage"
                    clearable>
                </el-input>
                <el-button type="primary" @click="sendMessage" class="send-button" :disabled="isLoading">
                    <i class="fa fa-paper-plane"></i> 发送
                </el-button>
            </div>
        </el-card>
    `
});
</script>

<style>
.ai-console-card {
    height: 100%;
    display: flex;
    flex-direction: column;
}

.ai-messages {
    flex-grow: 1;
    overflow-y: auto;
    padding: 10px;
    min-height: 400px;
    max-height: 600px;
    background-color: var(--chat-bg);
    border-radius: 4px;
    margin-bottom: 15px;
}

.message-item {
    display: flex;
    margin-bottom: 15px;
    animation: fadeIn 0.3s ease;
}

.user-message {
    flex-direction: row-reverse;
}

.message-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-color: var(--avatar-bg);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 10px;
    flex-shrink: 0;
}

.user-message .message-avatar {
    margin-right: 0;
    margin-left: 10px;
    background-color: var(--primary-color);
}

.message-content {
    max-width: 80%;
    padding: 10px 15px;
    border-radius: 18px;
    background-color: var(--message-bg);
    position: relative;
}

.user-message .message-content {
    background-color: var(--primary-color);
    color: white;
}

.message-time {
    font-size: 12px;
    color: var(--text-color-tertiary);
    margin-top: 5px;
    text-align: right;
}

.user-message .message-time {
    color: rgba(255, 255, 255, 0.7);
}

.ai-input-area {
    display: flex;
    gap: 10px;
}

.ai-input-area .el-input {
    flex-grow: 1;
}

.loading-indicator {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 10px;
    color: var(--text-color-secondary);
}

.loading-indicator .el-loading-spinner {
    margin-right: 8px;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}
</style>
