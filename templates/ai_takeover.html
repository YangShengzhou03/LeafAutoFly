{% extends 'base.html' %}

{% block content %}
    <div class="page-header">
        <h1>AI接管</h1>
    </div>

    <!-- 顶部配置栏 -->
    <div class="config-bar gradient-card" style="background: linear-gradient(135deg, #7B4EF3, #9D65F9);">
        <div class="config-item">
            <label>接管对象</label>
            <input type="text" placeholder="好友/群聊 备注，多个分号分隔">
        </div>
        <div class="config-item">
            <label>仅被@时触发</label>
            <label class="switch">
                <input type="checkbox">
                <span class="slider"></span>
            </label>
        </div>
        <div class="config-item">
            <label>人设</label>
            <input type="text" value="你很温馨，回复简单明了。">
        </div>
        <div class="config-item">
            <button class="ghost-btn">禁用模型</button>
        </div>
    </div>

    <!-- 定时器核心区 -->
    <div class="timer-container">
        <h2>Leaf Ai 已为您接管</h2>
        <div class="timer-display">00:00:00</div>
        <button class="start-btn" id="startTimer">
            <img src="{{ url_for('static', filename='images/play-icon.svg') }}" alt="开始">
        </button>
    </div>
{% endblock %}

{% block scripts %}
    <script>
        document.getElementById('startTimer').addEventListener('click', function() {
            let seconds = 0;
            const timerDisplay = document.querySelector('.timer-display');
            const startBtn = this;
            const icon = startBtn.querySelector('img');

            if (startBtn.classList.contains('running')) {
                // 停止定时器
                clearInterval(window.timerInterval);
                startBtn.classList.remove('running');
                icon.src = "{{ url_for('static', filename='images/play-icon.svg') }}";
            } else {
                // 启动定时器
                startBtn.classList.add('running');
                icon.src = "{{ url_for('static', filename='images/pause-icon.svg') }}";

                window.timerInterval = setInterval(function() {
                    seconds++;
                    const hours = Math.floor(seconds / 3600).toString().padStart(2, '0');
                    const minutes = Math.floor((seconds % 3600) / 60).toString().padStart(2, '0');
                    const secs = (seconds % 60).toString().padStart(2, '0');
                    timerDisplay.textContent = `${hours}:${minutes}:${secs}`;
                }, 1000);
            }
        });
    </script>
{% endblock %}